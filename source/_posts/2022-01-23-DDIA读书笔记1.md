---
title: DDIA读书笔记1
catalog: true
comments: true
indexing: true
header-img: ../../../../img/default.jpg
top: false
tocnum: true
tags:
  - DDIA
  - 数据库
date: 2022-01-23 12:13:51
subtitle:
categories:
- 读书笔记
- Database
---

# Chapter2.数据模型与查询语言
## 数据模型

NoSQL即"非sql"
### 关系模型
目前最常用的数据库模型，将数据存储为表

面临的问题：
目前大多数应用开发采用面向对象的编程语言，而编程语言**对象**与关系模型**表**之间的转换非常麻烦

### 文档模型
适用于记录之间有一对多关系或没有关系

类似于json的模型，将数据存储为树结构

一对多关系就形成了树结构，例如简历上一个人有多份工作，多个教育经历

面临的问题：
应用程序需要频繁访问整个文档时效率高，但只访问其中一部分数据时效率低，因为数据库通常会加载整个文档

### 图形模型
适用于一对多与多对多关系很常见的数据，可以表示一些关系表中难以表示的关系、联系

图模型中包括顶点和边，若用关系表来表示可以分为两个表

## 查询语言
### 命令式和声明式

命令式即编程语言，指导电脑每一步该怎么做

声明式即sql，声明将要完成的操作，具体实施交给底层

命令式对并发友好，且在源数据被更改的情况下命令式查询很可能出错，必须重写，而声明式没有这个问题

### MapReduce查询
（前几天还自己去啃论文，看得倒懂不懂的，DDIA上原来直接就有描述，太顶了）
MapReduce查询是一种底层查询模型，相对于sql等高级查询语言，高级语言是底层模型的应用

map函数会产生(emit,读原文就是看不明白这个单词)一个中间（intermediate)键值对，reduce函数则对这些中间键值对进行合并，具体来说就是把具有相同键的键值对进行求和等合并操作。

MapReduce是纯函数，只对传入的键值对进行操作，不执行额外查询操作。

MapReduce操作由一个主控程序控制，将map、reduce操作分别指派给不同的工作机器（worker）执行(联想到消费者-生产者？),并通过主机定时ping worker等操作来确保worker的正常工作，若worker宕机，再指派另一个worker执行前者的工作。

### 图模型查询语言
就是沿着边不断访问其他顶点的过程

例如查找BORN_IN边指向美国，LIVING_IN指向欧洲的所有顶点

代表有Cypher。

由于图模型可以用两个关系表来表示，所以查询也可以用sql，但是存在一些困难

### 三元存储
三元存储的思想几乎和图模型一样

以(主，谓1，宾1，谓2，宾2，……)的形式存储

主体是图中一个顶点

宾语是值时，（谓语，宾语）可以是一个键值对，是主体的一项属性

宾语是图中另一个顶点时，谓语就是一条边

三元存储的查询语言有SPARQL，比Cypher更简洁

### Datalog
是一项比较古老的语言。（但是古老的东西不代表思想古老，也许某时候会从老东西中获得启发）

存储思想类似于三元组
以 谓（主，宾）的形式存储，如name(usa,'United States')

查询过程：对查询语句通过查询数据库，生成中间词条，再从中间词条查询出结果。从查询到结果中间可能有多步中间词条。
